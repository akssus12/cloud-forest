<html>
<head>
    <title>Plant Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='index_style.css') }}" />
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <!--High CHART LIVE  -->
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/highcharts-more.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>
    <!--Gauge  -->
    <script type="text/javascript" src="http://pubnub.github.io/eon/lib/eon.js"></script>    
</head>

<body>
<h1>{{ msg }}'s Plant Story</h1>
<br>
<div class='cover'>
  <div><center><img id="videoElement" src="{{ url_for('stream') }}"/></center></div>
</div>
<br>
<div class="container-fluid">
  <div class="row">
      <div class="container-fluid" id="data-container"></div>
    </div>
</div>

<script>
var chart;

function requestData() {
    $.ajax({
        url: '/gauge',
        success: function(point) {
            var series1 = chart.series[0];
            var shift1 = series1.data.length > 20;

            var series2 = chart.series[1];
            var shift2 = series2.data.length > 20;

            // point[0] : timestamp, point[1] : temperature, point[2] : humidity
            series1.addPoint([point[0],point[1]], false, shift1);
            series2.addPoint([point[0],point[2]], true, shift2);

            setTimeout(requestData, 60000);
        },
    });
}
$(document).ready(function() {
    Highcharts.setOptions({
                global: {
                    useUTC: false
                }
            });

    chart = new Highcharts.Chart({
        chart: {
            renderTo: 'data-container',
            defaultSeriesType: 'spline',
            events: {
                load: requestData
            }
        },
        title: {
            text: 'Realtime Temperature/Humidity'
        },
        xAxis: {
            type: 'datetime',
            tickPixelInterval: 150,
            maxZoom: 20 * 1000
        },
        yAxis: {
            minPadding: 0.8,
            maxPadding: 0.2,
            title: {
                text: 'Degree',
                margin: 80
            }
        },
        series: [{
            name: 'Temperature', 
            data: []
        },
            {
            name: 'Humidity', 
            data: []
        }]
    });
});
</script>
</body>
</html>


